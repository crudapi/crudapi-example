(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[9],{"022c":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"q-pa-md q-gutter-sm"},[a("q-breadcrumbs",[a("q-breadcrumbs-el",{attrs:{label:"表关系管理"}}),a("q-breadcrumbs-el",{attrs:{label:"添加"}})],1),a("q-separator"),a("form",{staticClass:"q-pb-md",on:{submit:function(e){return e.preventDefault(),e.stopPropagation(),t.onSubmit.apply(null,arguments)}}},[a("div",{staticClass:"row items-baseline content-center justify-start q-py-md"},[a("div",{staticClass:"col-3 text-right required text-subtitle2 q-pr-md"},[t._v("类型:")]),a("q-select",{staticClass:"col-7",attrs:{outlined:"",options:t.relationTypeOptions,"emit-value":"","map-options":""},model:{value:t.metadataRelation.relationType,callback:function(e){t.$set(t.metadataRelation,"relationType",e)},expression:"metadataRelation.relationType"}})],1),a("div",{staticClass:"row items-baseline content-center justify-start q-py-md"},[a("div",{staticClass:"col-3 text-right required text-subtitle2 q-pr-md"},[t._v("源表:")]),a("q-select",{staticClass:"col-7",attrs:{outlined:"",options:t.tableOptions,"option-label":"caption","option-value":"id","map-options":""},on:{input:t.onFromTableUpdate},model:{value:t.metadataRelation.fromTable,callback:function(e){t.$set(t.metadataRelation,"fromTable",e)},expression:"metadataRelation.fromTable"}})],1),a("div",{staticClass:"row items-baseline content-center justify-start q-py-md"},[a("div",{staticClass:"col-3 text-right required text-subtitle2 q-pr-md"},[t._v("源列:")]),a("q-select",{staticClass:"col-7",attrs:{outlined:"",options:t.fromColumnOptions,"option-label":"caption","option-value":"id","map-options":""},model:{value:t.fromColumn,callback:function(e){t.fromColumn=e},expression:"fromColumn"}})],1),a("div",{staticClass:"row items-baseline content-center justify-start q-py-md"},[a("div",{staticClass:"col-3 text-right required text-subtitle2 q-pr-md"},[t._v("目标表:")]),a("q-select",{staticClass:"col-7",attrs:{outlined:"",options:t.tableOptions,"option-label":"caption","option-value":"id","map-options":""},on:{input:t.onToTableUpdate},model:{value:t.metadataRelation.toTable,callback:function(e){t.$set(t.metadataRelation,"toTable",e)},expression:"metadataRelation.toTable"}})],1),a("div",{staticClass:"row items-baseline content-center justify-start q-py-md"},[a("div",{staticClass:"col-3 text-right required text-subtitle2 q-pr-md"},[t._v("目标列:")]),a("q-select",{staticClass:"col-7",attrs:{outlined:"",options:t.toColumnOptions,"option-label":"caption","option-value":"id","map-options":""},model:{value:t.toColumn,callback:function(e){t.toColumn=e},expression:"toColumn"}})],1),a("div",{staticClass:"row items-baseline content-center justify-start"},[a("div",{staticClass:"col-3 text-right required text-subtitle2 q-pr-md"},[t._v("英文名称:")]),a("q-input",{ref:"metadataRelation.name",staticClass:"col-7",attrs:{placeholder:"请输入关系英文名称，如products","lazy-rules":"",rules:[function(t){return t&&t.length>0||"不能为空"}]},model:{value:t.metadataRelation.name,callback:function(e){t.$set(t.metadataRelation,"name",e)},expression:"metadataRelation.name"}})],1),a("div",{staticClass:"row items-baseline content-center justify-start q-py-md"},[a("div",{staticClass:"col-3 text-right required text-subtitle2 q-pr-md"},[t._v("中文名称:")]),a("q-input",{ref:"metadataRelation.caption",staticClass:"col-7",attrs:{placeholder:"请输入关系中文名称","lazy-rules":"",rules:[function(t){return t&&t.length>0||"不能为空"}]},model:{value:t.metadataRelation.caption,callback:function(e){t.$set(t.metadataRelation,"caption",e)},expression:"metadataRelation.caption"}})],1),a("div",{staticClass:"row justify-center"},[a("q-btn",{attrs:{unelevated:"",type:"submit",color:"primary",label:"保存"}})],1)])],1)},o=[],i=a("c973"),l=a.n(i),s=(a("4de4"),a("d3b7"),a("b0c0"),a("a4d3"),a("e01a"),a("96cf"),a("8e44")),r=a("ed08"),c={data:function(){return{loading:!0,tableOptions:[],relationTypeOptions:[{value:"OneToMany",label:"一对多"},{value:"ManyToOne",label:"多对一"},{value:"OneToOneMainToSub",label:"一对一(主子)"},{value:"OneToOneSubToMain",label:"一对一(子主)"}],fromColumnOptions:[],toColumnOptions:[],metadataRelation:{},fromColumn:null,toColumn:null}},created:function(){this.init(),console.info("created")},mounted:function(){console.info("mounted")},activated:function(){console.info("activated")},deactivated:function(){console.info("deactivated")},updated:function(){console.info("updated")},destroyed:function(){console.info("destroyed")},beforeRouteUpdate:function(t,e,a){console.info("beforeRouteUpdate"),this.init(t.params.id),a()},filters:{dateTimeFormat:function(t){return r["a"].dateTimeFormat(t)}},methods:{init:function(t){var e=this;return l()(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.info("init"),e.$store.commit("config/updateIsAllowBack",e.$route.meta.isAllowBack),t.next=4,e.loadData();case 4:case"end":return t.stop()}}),t)})))()},isCanRelation:function(t){return"TINYINT"===t.dataType||"SMALLINT"===t.dataType||"MEDIUMINT"===t.dataType||"INT"===t.dataType||"BIGINT"===t.dataType||"CHAR"===t.dataType||"VARCHAR"===t.dataType},onFromTableUpdate:function(){var t=this;console.info("onFromTableUpdate"),this.fromColumn=null,this.metadataRelation.fromTable?this.fromColumnOptions=this.metadataRelation.fromTable.columns.filter((function(e){return t.isCanRelation(e)})):this.fromColumnOptions=[]},onToTableUpdate:function(){var t=this;console.info("onToTableUpdate"),this.toColumn=null,this.metadataRelation.toTable?this.toColumnOptions=this.metadataRelation.toTable.columns.filter((function(e){return t.isCanRelation(e)})):this.toColumnOptions=[]},loadData:function(){var t=this;return l()(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t.loading=!0,e.next=4,s["e"].list(1,9999);case 4:a=e.sent,console.info(a),t.tableOptions=a,t.loading=!1,e.next=15;break;case 10:e.prev=10,e.t0=e["catch"](0),console.error(e.t0),t.loading=!1,t.$q.notify(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,10]])})))()},onSubmit:function(){var t=this;return l()(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.$q.loading.show({message:"提交中"}),e.prev=1,a={relationType:t.metadataRelation.relationType,name:t.metadataRelation.name,caption:t.metadataRelation.caption,description:t.metadataRelation.description,fromTable:{id:t.metadataRelation.fromTable.id},fromColumn:{id:t.fromColumn.id},toTable:{id:t.metadataRelation.toTable.id},toColumn:{id:t.toColumn.id}},e.next=5,s["c"].create(a);case 5:t.$q.loading.hide(),t.$q.notify("添加成功"),t.$router.go(-1),e.next=14;break;case 10:e.prev=10,e.t0=e["catch"](1),console.info(e.t0),t.$q.loading.hide();case 14:case"end":return e.stop()}}),e,null,[[1,10]])})))()}}},u=c,d=(a("2c85"),a("2877")),m=a("ead5"),p=a("079e"),f=a("eb85"),b=a("ddd8"),v=a("27f9"),C=a("9c40"),T=a("eebe"),h=a.n(T),R=Object(d["a"])(u,n,o,!1,null,null,null);e["default"]=R.exports;h()(R,"components",{QBreadcrumbs:m["a"],QBreadcrumbsEl:p["a"],QSeparator:f["a"],QSelect:b["a"],QInput:v["a"],QBtn:C["a"]})},2750:function(t,e,a){},"2c85":function(t,e,a){"use strict";a("2750")}}]);