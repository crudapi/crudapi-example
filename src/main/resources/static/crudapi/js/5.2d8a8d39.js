(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[5],{"1c55":function(e,t,n){"use strict";n("90a2")},"63c2":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-layout",{staticClass:"bg-page",staticStyle:{"z-index":"1"},attrs:{view:"hhh lpr lfr"}},[n("q-header",{staticClass:"bg-white text-black",attrs:{"height-hint":"98"}},[n("q-toolbar",[n("q-toolbar-title",[n("q-breadcrumbs",[n("q-breadcrumbs-el",{attrs:{label:"页面构建"}}),n("q-breadcrumbs-el",{attrs:{label:e.table.caption}})],1)],1)],1),n("q-separator")],1),n("q-drawer",{attrs:{"show-if-above":"",side:"left",bordered:""},model:{value:e.left,callback:function(t){e.left=t},expression:"left"}},[n("div",{staticClass:"q-pa-md"},[n("draggable",{staticClass:"dragArea list-group",attrs:{list:e.unselectedList,group:{name:"people"}},on:{change:e.log}},e._l(e.unselectedList,(function(t){return n("q-list",{key:t.columnId,attrs:{bordered:"",separator:""}},[n("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{clickable:""}},[n("q-item-section",{attrs:{avatar:""}},[n("q-icon",{attrs:{name:e._f("iconFormat")(t),color:"primary","text-color":"white"}})],1),n("q-item-section",[n("q-item-label",{attrs:{lines:"1"}},[e._v(e._s(t.column.caption))]),n("q-item-label",{attrs:{caption:""}},[e._v(e._s(t.column.name))])],1)],1)],1)})),1)],1)]),n("q-drawer",{attrs:{"show-if-above":"",side:"right",bordered:""},model:{value:e.right,callback:function(t){e.right=t},expression:"right"}},[e.currentElement.column?n("div",{staticClass:"q-pa-md"},[n("div",{staticClass:"q-pa-md"},[e._v(" \n        字段: "+e._s(e.currentElement.column.caption+", "+e.currentElement.column.name)+"\n      ")]),n("div",{staticClass:"q-pa-md"},[e._v(" \n        栅格宽度:\n      ")]),n("div",{staticClass:"q-pa-md"},[n("q-slider",{attrs:{color:"primary",min:1,step:1,max:12,label:"","label-always":""},model:{value:e.currentElement.width,callback:function(t){e.$set(e.currentElement,"width",t)},expression:"currentElement.width"}})],1)]):e._e()]),n("q-page-container",[n("div",{staticClass:"q-pa-md form-build-body",class:e.device},[n("div",{staticClass:"q-pb-md row   justify-right"},[n("div",{staticClass:"q-px-md"},[n("q-radio",{attrs:{val:"pc",label:"电脑"},on:{input:e.deviceChange},model:{value:e.device,callback:function(t){e.device=t},expression:"device"}}),n("q-radio",{attrs:{val:"pad",label:"平板"},on:{input:e.deviceChange},model:{value:e.device,callback:function(t){e.device=t},expression:"device"}}),n("q-radio",{attrs:{val:"phone",label:"手机"},on:{input:e.deviceChange},model:{value:e.device,callback:function(t){e.device=t},expression:"device"}})],1),n("div",{staticClass:"q-px-md"},[n("q-radio",{attrs:{val:"create",label:"创建"},on:{input:e.typeChange},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}}),n("q-radio",{attrs:{val:"update",label:"编辑"},on:{input:e.typeChange},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}})],1),n("div",{staticClass:"q-px-md"},[n("q-btn",{staticClass:"q-mx-md",attrs:{unelevated:"",color:"primary",label:"保存"},on:{click:e.onSubmitClick}}),n("q-btn",{attrs:{unelevated:"",color:"negative",label:"删除"},on:{click:e.onDeleteClick}})],1)]),n("q-separator"),n("draggable",{staticClass:"dragArea list-group row",attrs:{list:e.selectedList,group:"people"},on:{change:e.log}},e._l(e.selectedList,(function(t){return n("div",{key:t.columnId,staticClass:"list-group-item q-pa-md",class:e._f("classFormat")(t,e.currentElement),on:{click:function(n){return e.selectForEdit(t)}}},[n("div",[n("div",{class:{required:!t.column.nullable}},[e._v("\n              "+e._s(t.column.caption)+":\n            ")]),e.isStringType(t)?n("q-input",{attrs:{readonly:"",placeholder:t.column.description,type:t.isPwd?"password":"text"},scopedSlots:e._u([t.isText?null:{key:"append",fn:function(){return[n("q-icon",{staticClass:"cursor-pointer",attrs:{name:t.isPwd?"visibility_off":"visibility"},on:{click:function(e){t.isPwd=!t.isPwd}}})]},proxy:!0}],null,!0),model:{value:t.column.value,callback:function(n){e.$set(t.column,"value",n)},expression:"formElement.column.value"}}):e.isTextType(t)?n("q-editor",{attrs:{readonly:"",placeholder:t.column.description},model:{value:e.textValue,callback:function(t){e.textValue=t},expression:"textValue"}}):e.isDateTimeType(t)?n("q-input",{attrs:{readonly:""},scopedSlots:e._u([{key:"prepend",fn:function(){return[n("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[n("q-popup-proxy",{ref:"qDateProxy",refInFor:!0,attrs:{"transition-show":"scale","transition-hide":"scale"}},[n("q-date",{attrs:{mask:"YYYY-MM-DD HH:mm:ss"},on:{input:function(t){return e.hideRefPopProxyAction("qDateProxy")}}})],1)],1)]},proxy:!0},{key:"append",fn:function(){return[n("q-icon",{staticClass:"cursor-pointer",attrs:{name:"access_time"}},[n("q-popup-proxy",{ref:"qTimeProxy",refInFor:!0,attrs:{"transition-show":"scale","transition-hide":"scale"}},[n("q-time",{attrs:{mask:"YYYY-MM-DD HH:mm:ss",format24h:"","with-seconds":""},on:{input:function(t){return e.hideRefPopProxyAction("qTimeProxy")}}})],1)],1)]},proxy:!0}],null,!0)}):e.isDateType(t)?n("q-input",{attrs:{readonly:""},scopedSlots:e._u([{key:"append",fn:function(){return[n("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[n("q-popup-proxy",{ref:"qDateProxy",refInFor:!0,attrs:{"transition-show":"scale","transition-hide":"scale"}},[n("q-date",{attrs:{mask:"YYYY-MM-DD"},on:{input:function(t){return e.hideRefPopProxyAction("qDateProxy")}}})],1)],1)]},proxy:!0}],null,!0)}):e.isTimeType(t)?n("q-input",{attrs:{readonly:""},scopedSlots:e._u([{key:"append",fn:function(){return[n("q-icon",{staticClass:"cursor-pointer",attrs:{name:"access_time"}},[n("q-popup-proxy",{ref:"qTimeProxy",refInFor:!0,attrs:{"transition-show":"scale","transition-hide":"scale"}},[n("q-time",{attrs:{mask:"HH:mm:ss",format24h:"","with-seconds":""},on:{input:function(t){return e.hideRefPopProxyAction("qTimeProxy")}}})],1)],1)]},proxy:!0}],null,!0)}):e.isBoolType(t)?n("q-toggle",{attrs:{readonly:""},model:{value:t.column.value,callback:function(n){e.$set(t.column,"value",n)},expression:"formElement.column.value"}}):e.isNumberType(t)?n("q-input",{attrs:{readonly:"",placeholder:t.column.description,type:"number"},model:{value:t.column.value,callback:function(n){e.$set(t.column,"value",n)},expression:"formElement.column.value"}}):e.isAttachmentType(t)?n("CFile",{model:{value:t.column.value,callback:function(n){e.$set(t.column,"value",n)},expression:"formElement.column.value"}}):n("q-input",{attrs:{readonly:"",placeholder:t.column.description,type:t.isPwd?"password":"text"},scopedSlots:e._u([t.isText?null:{key:"append",fn:function(){return[n("q-icon",{staticClass:"cursor-pointer",attrs:{name:t.isPwd?"visibility_off":"visibility"},on:{click:function(e){t.isPwd=!t.isPwd}}})]},proxy:!0}],null,!0),model:{value:t.column.value,callback:function(n){e.$set(t.column,"value",n)},expression:"formElement.column.value"}})],1),n("div",{staticClass:"row reverse editable-element-action-buttons"},[n("div",{staticClass:"justify-end q-pt-xs"},[e.isSelectedForEdit(t)?n("q-btn",{staticClass:"editable-element-button",attrs:{color:"red",icon:"delete",round:"",unelevated:"",size:"xs"},on:{click:function(n){return e.deleteElement(t)}}},[n("q-tooltip",[e._v("移除")])],1):e._e()],1)])])})),0)],1)])],1)},i=[],r=n("448a"),o=n.n(r),l=n("c973"),c=n.n(l),s=(n("e9c4"),n("c740"),n("99af"),n("fb6a"),n("7db0"),n("d3b7"),n("159b"),n("b0c0"),n("96cf"),n("b76a")),u=n.n(s),d=n("8e44"),p=n("11ec"),m={name:"formBulder",components:{draggable:u.a},data:function(){return{left:!0,right:!0,unselectedList:[],selectedList:[],loading:!0,type:"create",device:"pc",table:{},formBuilders:[],currentElement:{},textValue:"",fileValue:""}},created:function(){var e=this;return c()(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.init();case 2:console.info("created");case 3:case"end":return t.stop()}}),t)})))()},mounted:function(){console.info("mounted")},activated:function(){console.info("activated")},deactivated:function(){console.info("deactivated")},updated:function(){console.info("updated")},destroyed:function(){console.info("destroyed")},filters:{iconFormat:function(e){var t=e.column,n="text_rotate_vertical";return"PASSWORD"===t.dataType?n="lock":"DATETIME"===t.dataType?n="calendar_today":"DATE"===t.dataType?n="event":"TIME"===t.dataType||"TIME"===t.dataType?n="schedule":"ATTACHMENT"===t.dataType?n="upload_file":"LONGBLOB"===t.dataType?n="attachment":"DECIMAL"===t.dataType&&(n="format_list_numbered"),n},classFormat:function(e,t){var n="";return e.width&&(n="col-"+e.width),t&&t.column&&t.column.id===e.column.id&&(n+=" selected"),n},jsonFormat:function(e){return JSON.stringify(e,null,2)}},computed:{},methods:{log:function(e){window.console.log(e)},init:function(e){var t=this;return c()(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.$store.commit("config/updateIsAllowBack",t.$route.meta.isAllowBack),n.next=3,t.loadData(e);case 3:case"end":return n.stop()}}),n)})))()},isTextType:function(e){return"TEXT"===e.column.dataType||"LONGTEXT"===e.column.dataType},isStringType:function(e){return"CHAR"===e.column.dataType||"VARCHAR"===e.column.dataType},isNumberType:function(e){return"TINYINT"===e.column.dataType||"SMALLINT"===e.column.dataType||"MEDIUMINT"===e.column.dataType||"INT"===e.column.dataType||"BIGINT"===e.column.dataType},isDateType:function(e){return"DATE"===e.column.dataType},isTimeType:function(e){return"TIME"===e.column.dataType},isDateTimeType:function(e){return"DATETIME"===e.column.dataType},isBoolType:function(e){return"BOOL"===e.column.dataType},isAttachmentType:function(e){return"ATTACHMENT"===e.column.dataType},hideRefPopProxyAction:function(e){for(var t=this.$refs[e],n=0;n<t.length;n++)t[n].hide()},selectForEdit:function(e){this.currentElement=e},isSelectedForEdit:function(e){return this.currentElement&&this.currentElement.column&&this.currentElement.column.id===e.column.id},currentElementWidthInput:function(e){console.log("currentElementWidthInput"),this.$forceUpdate()},deleteElement:function(e){var t=this.selectedList.findIndex((function(t){return t.column.id===e.column.id}));t>=0&&(this.selectedList=[].concat(o()(this.selectedList.slice(0,t)),o()(this.selectedList.slice(t+1))),this.unselectedList.push(e)),this.currentElement={},this.$forceUpdate()},loadData:function(e){var t=this;return c()(regeneratorRuntime.mark((function n(){var a,i,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.$q.loading.show({message:"加载中"}),n.prev=1,t.loading=!0,a=e||t.$route.params.id,n.next=6,d["e"].get(a);case 6:return i=n.sent,t.table=i,r={tableId:a},n.next=11,d["h"].list("tableFormBuilder",0,999,null,r,null);case 11:t.formBuilders=n.sent,t.setFormBuilder(),t.loading=!1,t.$q.loading.hide(),n.next=23;break;case 17:n.prev=17,n.t0=n["catch"](1),console.error(n.t0),t.loading=!1,t.$q.loading.hide(),t.$q.notify(n.t0);case 23:case"end":return n.stop()}}),n,null,[[1,17]])})))()},deviceChange:function(e,t){console.log(e),this.currentElement={},this.setFormBuilder()},typeChange:function(e,t){console.log(e),this.currentElement={},this.setFormBuilder()},setFormBuilder:function(){var e=this,t=this.table.columns,n=this.formBuilders.find((function(t){return t.device===e.device&&t.type===e.type})),a=[],i=[];n?(i=JSON.parse(n.body),i.forEach((function(e){e.column=t.find((function(t){return t.id===e.columnId}))})),t.forEach((function(e){var t={columnId:e.id,column:e,width:12};i.findIndex((function(e){return e.columnId===t.columnId}))<0&&a.push(t)}))):t.forEach((function(e){var t={columnId:e.id,column:e,width:12};"PASSWORD"===e.dataType?(t.isText=!1,t.isPwd=!0):(t.isText=!0,t.isPwd=!1),"createdDate"===e.name||"lastModifiedDate"===e.name||"fullTextBody"===e.name?a.push(t):i.push(t)})),this.unselectedList=a,this.selectedList=i},onSubmitClick:function(){var e=this;return c()(regeneratorRuntime.mark((function t(){var n,a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.$q.loading.show({message:"提交中"}),t.prev=1,n=Object(p["a"])(!0,[],e.selectedList),n.forEach((function(e){delete e.column})),a={name:e.device+" "+e.type,device:e.device,type:e.type,body:JSON.stringify(n),tableId:e.table.id},i=e.formBuilders.find((function(t){return t.device===e.device&&t.type===e.type})),i){t.next=11;break}return t.next=9,d["h"].create("tableFormBuilder",a);case 9:t.next=13;break;case 11:return t.next=13,d["h"].update("tableFormBuilder",i.id,a);case 13:return e.$q.loading.hide(),e.$q.notify("保存成功"),t.next=17,e.loadData(e.table.id);case 17:t.next=23;break;case 19:t.prev=19,t.t0=t["catch"](1),e.$q.loading.hide(),console.info(t.t0);case 23:case"end":return t.stop()}}),t,null,[[1,19]])})))()},onDeleteClick:function(){var e=this;return c()(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.$q.loading.show({message:"提交中"}),t.prev=1,n=e.formBuilders.find((function(t){return t.type===e.type})),!n){t.next=12;break}return t.next=6,d["h"].delete("tableFormBuilder",n.id);case 6:return e.$q.loading.hide(),e.$q.notify("删除成功"),t.next=10,e.loadData(e.table.id);case 10:t.next=14;break;case 12:e.$q.loading.hide(),e.$q.notify("已经为空");case 14:t.next=20;break;case 16:t.prev=16,t.t0=t["catch"](1),e.$q.loading.hide(),console.info(t.t0);case 20:case"end":return t.stop()}}),t,null,[[1,16]])})))()}}},f=m,v=(n("1c55"),n("2877")),h=n("4d5a"),y=n("e359"),b=n("65c6"),q=n("9c40"),x=n("6ac5"),T=n("ead5"),g=n("079e"),w=n("eb85"),k=n("9404"),E=n("1c1c"),C=n("66e5"),I=n("4074"),P=n("0016"),_=n("0170"),D=n("c1d0"),$=n("09e3"),A=n("3786"),B=n("27f9"),L=n("d66b"),Q=n("7cbe"),S=n("52ee"),F=n("ca78"),R=n("9564"),M=n("05c0"),N=n("714f"),Y=n("eebe"),O=n.n(Y),H=Object(v["a"])(f,a,i,!1,null,"db246b1e",null);t["default"]=H.exports;O()(H,"components",{QLayout:h["a"],QHeader:y["a"],QToolbar:b["a"],QBtn:q["a"],QToolbarTitle:x["a"],QBreadcrumbs:T["a"],QBreadcrumbsEl:g["a"],QSeparator:w["a"],QDrawer:k["a"],QList:E["a"],QItem:C["a"],QItemSection:I["a"],QIcon:P["a"],QItemLabel:_["a"],QSlider:D["a"],QPageContainer:$["a"],QRadio:A["a"],QInput:B["a"],QEditor:L["a"],QPopupProxy:Q["a"],QDate:S["a"],QTime:F["a"],QToggle:R["a"],QTooltip:M["a"]}),O()(H,"directives",{Ripple:N["a"]})},"90a2":function(e,t,n){}}]);