(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[26],{b57a:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"q-pa-md q-gutter-sm bg-page"},[n("q-breadcrumbs",[n("q-breadcrumbs-el",{attrs:{label:"表管理"}}),n("q-breadcrumbs-el",{attrs:{label:"数据库逆向"}})],1),n("q-separator"),n("div",{staticClass:"bg-table-list"},[n("q-banner",{staticClass:"text-black bg-listcolor",attrs:{"inline-actions":""},scopedSlots:e._u([{key:"action",fn:function(){return[n("q-btn",{attrs:{disable:0==e.selected.length,unelevated:"",color:"primary",label:"批量逆向"},on:{click:function(t){return e.onReverseClickAction()}}})]},proxy:!0}])}),n("q-table",{attrs:{data:e.data,columns:e.columns,"row-key":"id",selection:"multiple",selected:e.selected,"visible-columns":e.visibleColumns,pagination:e.tablePagination,loading:e.loading,"hide-bottom":"",flat:""},on:{"update:selected":function(t){e.selected=t},"update:pagination":function(t){e.tablePagination=t}},scopedSlots:e._u([{key:"body",fn:function(t){return[n("q-tr",{attrs:{props:t}},[n("q-td",[n("q-checkbox",{model:{value:t.selected,callback:function(n){e.$set(t,"selected",n)},expression:"props.selected"}})],1),n("q-td",{key:"dataClickAction",attrs:{props:t}},[n("q-btn",{attrs:{unelevated:"",color:"primary",label:"逆向",flat:"",dense:""},on:{click:function(n){return e.onReverseClickAction(t.row.tableName)}}})],1),n("q-td",{key:"id",attrs:{props:t}},[e._v(e._s(t.row.id))]),n("q-td",{key:"tableSchema",attrs:{props:t}},[n("span",[e._v(e._s(t.row.tableSchema))])]),n("q-td",{key:"tableName",attrs:{props:t}},[n("span",[e._v(e._s(t.row.tableName))])]),n("q-td",{key:"comment",attrs:{props:t}},[n("span",[e._v(e._s(t.row.comment))])])],1)]}}])}),e.data.length>0?n("q-separator"):e._e(),n("div",{staticClass:"q-py-md"},[n("CPage",{on:{input:e.onRequestAction},model:{value:e.pagination,callback:function(t){e.pagination=t},expression:"pagination"}})],1)],1)],1)},r=[],o=n("c973"),i=n.n(o),c=(n("d3b7"),n("159b"),n("e9c4"),n("ac1f"),n("841c"),n("96cf"),n("8e44")),s={data:function(){return{data:[],loading:!0,selected:[],search:"",queryColumns:[],pagination:{page:1,rowsPerPage:100,count:0},tablePagination:{rowsPerPage:100},visibleColumns:["id","tableSchema","tableName","comment","dataClickAction"],columns:[{name:"dataClickAction",align:"center",label:"操作",field:"dataClickAction",sortable:!0},{name:"id",label:"编号",align:"left",field:function(e){return e.id},format:function(e){return"".concat(e)},sortable:!0},{name:"tableSchema",required:!0,label:"表架构",align:"left",field:function(e){return e.tableSchema},format:function(e){return"".concat(e)},sortable:!0},{name:"tableName",required:!0,label:"表名称",align:"left",field:function(e){return e.tableName},format:function(e){return"".concat(e)},sortable:!0},{name:"comment",required:!0,label:"表注释",align:"left",field:function(e){return e.comment},format:function(e){return"".concat(e)},sortable:!0}]}},created:function(){var e=this;return i()(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.init();case 2:return t.next=4,e.onRefresh();case 4:case"end":return t.stop()}}),t)})))()},mounted:function(){console.info("mounted")},activated:function(){console.info("activated")},deactivated:function(){console.info("deactivated")},updated:function(){console.info("updated")},destroyed:function(){console.info("destroyed")},beforeRouteUpdate:function(e,t,n){var a=this;return i()(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.info("beforeRouteUpdate"),e.next=3,a.init();case 3:return e.next=5,a.onRefresh();case 5:n();case 6:case"end":return e.stop()}}),e)})))()},filters:{},methods:{onRefresh:function(){var e=this;return i()(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.selected=[],t.next=3,e.fetchFromServer();case 3:case"end":return t.stop()}}),t)})))()},onRequestAction:function(e){console.info("onRequestAction"),console.info(e),this.tablePagination.rowsPerPage=e.rowsPerPage,this.fetchFromServer()},onReverseClickAction:function(e){var t=this;return i()(regeneratorRuntime.mark((function n(){var a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:a=[],t.selected.forEach((function(e){a.push(e.tableName)})),console.info(JSON.stringify(a));try{t.$q.dialog({title:"逆向",message:"确认逆向吗？",ok:{unelevated:!0},cancel:{color:"negative",unelevated:!0},persistent:!1}).onOk(i()(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!e){n.next=5;break}return n.next=3,c["e"].reverse(e);case 3:n.next=7;break;case 5:return n.next=7,c["e"].batchReverse(a);case 7:t.$q.notify("逆向成功"),t.$root.$emit("updateMenuTree"),t.onRefresh();case 10:case"end":return n.stop()}}),n)})))).onCancel((function(){})).onDismiss((function(){console.info("I am triggered on both OK and Cancel")}))}catch(r){t.$q.notify("逆向失败")}case 4:case"end":return n.stop()}}),n)})))()},fetchFromServer:function(){var e=this;return i()(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,e.data=[],t.prev=2,n={},console.info("query"+JSON.stringify(n)),t.next=7,c["e"].getMetadatas(e.pagination.page,e.pagination.rowsPerPage,e.search,n);case 7:a=t.sent,e.pagination.count=a.length,e.data=a,e.loading=!1,t.next=17;break;case 13:t.prev=13,t.t0=t["catch"](2),e.loading=!1,console.error(t.t0);case 17:case"end":return t.stop()}}),t,null,[[2,13]])})))()},init:function(){var e=this;return i()(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:console.info("init"),e.$store.commit("config/updateIsAllowBack",e.$route.meta.isAllowBack),e.selected=[],e.search="";case 4:case"end":return t.stop()}}),t)})))()}}},l=s,u=n("2877"),d=n("ead5"),f=n("079e"),m=n("eb85"),p=n("54e1"),b=n("9c40"),g=n("eaac"),h=n("bd08"),v=n("db86"),w=n("8f8e"),k=n("eebe"),q=n.n(k),R=Object(u["a"])(l,a,r,!1,null,null,null);t["default"]=R.exports;q()(R,"components",{QBreadcrumbs:d["a"],QBreadcrumbsEl:f["a"],QSeparator:m["a"],QBanner:p["a"],QBtn:b["a"],QTable:g["a"],QTr:h["a"],QTd:v["a"],QCheckbox:w["a"]})}}]);